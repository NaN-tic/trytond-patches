diff -r d1160d8084c5 sale.py
--- a/trytond/trytond/modules/sale/sale.py	Wed Sep 27 18:37:32 2017 +0200
+++ b/trytond/trytond/modules/sale/sale.py	Tue Nov 07 06:59:18 2017 +0100
@@ -580,12 +580,12 @@
         Search on shipments or returns
         '''
         def method(self, name, clause):
-            nested = clause[0].lstrip(name)
-            if nested:
-                return [('lines.moves.shipment' + nested,)
-                    + tuple(clause[1:3]) + (model_name,) + tuple(clause[3:])]
+            if isinstance(clause[2], basestring):
+                target = 'rec_name'
             else:
-                return [('lines.moves.shipment',) + tuple(clause[1:3])]
+                target = 'id'
+            return [('lines.moves.shipment.' + target,) + tuple(clause[1:])
+                + (model_name,)]
         return classmethod(method)
 
     search_shipments = search_shipments_returns('stock.shipment.out')
